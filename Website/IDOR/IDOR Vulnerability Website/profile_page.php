<?php
// Masukkan file konfigurasi
@include 'config.php';

// Periksa apakah user sudah login
if (!isset($_COOKIE['user_name']) || !isset($_COOKIE['user_id'])) {
    header('location:login_form.php');
    exit();
}

$username = "";
$email = "";

// Menggunakan $_SESSION['user_id'] untuk mengambil profil pengguna
$user_id = $_COOKIE['user_id'];

// Query untuk mengambil data pengguna dari database berdasarkan user_id
$query = "SELECT * FROM users WHERE id = $user_id";
$result = mysqli_query($conn, $query);

if ($result && mysqli_num_rows($result) == 1) {
    $row = mysqli_fetch_assoc($result);
    $username = $row['name'];
    $email = $row['email'];
} else {
    echo "Pengguna tidak ditemukan";
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>User Profile</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <div class="content">
            <h1>User Profile</h1>
            <?php if (!empty($username) && !empty($email)) { ?>
                <p>Nama: <?php echo $username; ?></p>
                <p>Email: <?php echo $email; ?></p>
                <div class="profile-container">
                    <form action="update_profile.php" method="post">
                        <input type="hidden" name="user_id" value="<?php echo $user_id; ?>">
                        <label for="new_username">Nama Baru:</label>
                        <input type="text" id="new_username" name="new_username"><br>
                        
                        <label for="new_password">Kata Sandi Baru:</label>
                        <input type="password" id="new_password" name="new_password"><br>
                        
                        <input class="btn" type="submit" value="Simpan Perubahan">
                        <a href="homepage.php" class="btn">Home</a>
                    </form>
                </div>
            <?php } ?>
        </div>
    </div>
</body>
</html>
